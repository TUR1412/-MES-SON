# MES项目开发指南

> **更新时间：2025-06-05 09:40**  
> **适用对象：全体团队成员**

## 🚀 快速开始

### 📥 环境准备

**必需工具：**
- Visual Studio 2019/2022 或 VS Code
- .NET Framework 4.8 SDK
- Git for Windows
- MySQL 8.0（可选，用于数据库开发）

**获取代码：**
```bash
# 克隆项目
git clone https://github.com/TUR1412/-MES-SON.git
cd MES-SON

# 切换到开发分支
git checkout develop

# 验证编译
dotnet build MES.sln

# 运行程序
src\MES.UI\bin\Debug\MES.UI.exe
```

### 🌿 创建功能分支

```bash
# L成员（物料管理）
git checkout -b feature/L-material-management
git push -u origin feature/L-material-management

# H成员（生产管理）
git checkout -b feature/H-production-management
git push -u origin feature/H-production-management

# S成员（车间管理）
git checkout -b feature/S-workshop-management
git push -u origin feature/S-workshop-management
```

## 👨‍💻 各成员开发指导

### 🔥 L成员 - 立即可开始！

**你的DAL层已完全就绪，可以直接开始BLL层开发！**

#### 可用的DAL类
```csharp
// 物料管理
using MES.DAL.Material;
using MES.Models.Material;

var materialDAL = new MaterialDAL();
var materials = materialDAL.GetAll();                    // 获取所有物料
var material = materialDAL.GetByMaterialCode("M001");    // 根据编码查询
var categoryMaterials = materialDAL.GetByCategory("原材料"); // 根据类别查询

// BOM管理
var bomDAL = new BOMDAL();
var boms = bomDAL.GetByProductId(1);                     // 根据产品ID获取BOM
var bom = bomDAL.GetByBOMCode("BOM001");                 // 根据BOM编码查询
```

#### 开发步骤
1. **创建BLL层类**：在`src/MES.BLL/Material/`目录下创建MaterialBLL.cs和BOMBLL.cs
2. **创建UI界面**：在`src/MES.UI/Forms/Material/`目录下创建物料管理窗体
3. **功能测试**：确保增删改查功能正常

### ⏳ H成员 - 需先创建模型类

#### 第1步：创建ProductionOrderInfo模型

在`src/MES.Models/Production/`目录下创建`ProductionOrderInfo.cs`：

```csharp
using System;
using MES.Models.Base;

namespace MES.Models.Production
{
    public class ProductionOrderInfo : BaseModel
    {
        public string OrderNo { get; set; }           // 订单编号
        public int MaterialId { get; set; }          // 物料ID
        public decimal Quantity { get; set; }        // 生产数量
        public string Status { get; set; }           // 订单状态
        public DateTime PlanStartTime { get; set; }  // 计划开始时间
        public DateTime PlanEndTime { get; set; }    // 计划完成时间
        public DateTime? ActualStartTime { get; set; } // 实际开始时间
        public DateTime? ActualEndTime { get; set; }   // 实际完成时间
        public int Priority { get; set; }            // 优先级
        public string Remarks { get; set; }          // 备注
        
        public ProductionOrderInfo()
        {
            Status = "待开始";
            Priority = 1;
        }
    }
}
```

#### 第2步：更新项目文件

在`src/MES.Models/MES.Models.csproj`中添加：
```xml
<Compile Include="Production\ProductionOrderInfo.cs" />
```

在`src/MES.DAL/MES.DAL.csproj`中取消注释：
```xml
<Compile Include="Production\ProductionOrderDAL.cs" />
```

#### 第3步：验证编译

运行：`dotnet build src/MES.DAL/MES.DAL.csproj`

### ⏳ S成员 - 需先创建模型类

#### 第1步：创建WorkshopInfo模型

在`src/MES.Models/Workshop/`目录下创建`WorkshopInfo.cs`：

```csharp
using System;
using MES.Models.Base;

namespace MES.Models.Workshop
{
    public class WorkshopInfo : BaseModel
    {
        public string WorkshopCode { get; set; }     // 车间编码
        public string WorkshopName { get; set; }     // 车间名称
        public string Department { get; set; }       // 所属部门
        public string Status { get; set; }           // 车间状态
        public string Manager { get; set; }          // 车间负责人
        public string Location { get; set; }         // 车间位置
        public int Capacity { get; set; }            // 产能信息
        public int EquipmentCount { get; set; }      // 设备数量
        public int WorkerCount { get; set; }         // 工人数量
        public string Description { get; set; }      // 描述
        
        public WorkshopInfo()
        {
            Status = "正常";
            Capacity = 0;
            EquipmentCount = 0;
            WorkerCount = 0;
        }
    }
}
```

#### 第2步：更新项目文件

在`src/MES.Models/MES.Models.csproj`中添加：
```xml
<Compile Include="Workshop\WorkshopInfo.cs" />
```

在`src/MES.DAL/MES.DAL.csproj`中取消注释：
```xml
<Compile Include="Workshop\WorkshopDAL.cs" />
```

#### 第3步：验证编译

运行：`dotnet build src/MES.DAL/MES.DAL.csproj`

## 📁 项目结构

```
MES-SON/
├── src/
│   ├── MES.Common/     # 公共组件（日志、配置等）
│   ├── MES.Models/     # 数据模型
│   ├── MES.DAL/        # 数据访问层
│   ├── MES.BLL/        # 业务逻辑层
│   └── MES.UI/         # 用户界面层
├── database/           # 数据库脚本
├── docs/              # 项目文档
└── README.md          # 项目说明
```

## 🔧 开发规范

### 命名约定
- **类名：** PascalCase（如：MaterialBLL）
- **方法名：** PascalCase（如：GetAllMaterials）
- **变量名：** camelCase（如：materialList）
- **常量：** UPPER_CASE（如：MAX_RETRY_COUNT）

### 异常处理
```csharp
try
{
    // 业务逻辑
}
catch (Exception ex)
{
    LogManager.Error("操作描述", ex);
    throw new MESException("用户友好的错误信息", ex);
}
```

### 日志记录
```csharp
LogManager.Info("操作成功信息");
LogManager.Warning("警告信息");
LogManager.Error("错误信息", exception);
```

## 📝 日常开发流程

### 🌅 每日开始工作
```bash
# 1. 切换到你的功能分支
git checkout feature/你的分支名

# 2. 拉取最新更改
git pull origin feature/你的分支名

# 3. 同步develop分支的更新
git fetch origin
git merge origin/develop

# 4. 开始编码...
```

### 🌆 每日结束工作
```bash
# 1. 添加所有更改
git add .

# 2. 提交更改
git commit -m "你的成员标识: 模块 - 今天完成的功能"

# 3. 推送到远程
git push origin feature/你的分支名
```

### 📋 提交消息示例
```
L: 物料管理 - 完成物料信息增删改查功能
H: 生产管理 - 实现生产订单创建界面
S: 车间管理 - 添加设备状态监控组件
```

## 🖥️ 界面开发指南

### 🎨 设计器使用
1. **打开MainForm.cs[设计]** - 可以看到完整布局
2. **在panelMain中设计** - 主工作区域
3. **或创建新窗体** - 独立的功能窗体
4. **使用treeViewModules** - 左侧导航树

### 🎯 界面规范
- **字体：** 微软雅黑
- **主色调：** 蓝色系 (#337ab7)
- **成功色：** 绿色 (#5cb85c)
- **警告色：** 橙色 (#f0ad4e)
- **错误色：** 红色 (#d9534f)

## 🆘 获取帮助

### 🔍 自助解决
1. **查看错误日志** - `Logs/` 目录下的日志文件
2. **检查编译错误** - Visual Studio错误列表
3. **查阅项目文档** - `docs/` 目录下的文档

### 💬 寻求帮助
1. **GitHub Issues** - 创建问题报告
2. **团队群聊** - 及时沟通
3. **找天帝** - 技术难题和架构问题

## 📚 重要文档

- **项目总览：** `docs/项目总览.md`
- **Git工作流程：** `docs/Git工作流程.md`
- **DAL层详细说明：** `src/MES.DAL/README.md`

---

**开始编码，创造卓越的MES系统！** 🚀
